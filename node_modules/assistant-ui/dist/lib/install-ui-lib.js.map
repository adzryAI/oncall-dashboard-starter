{"version":3,"sources":["../../src/lib/install-ui-lib.ts"],"sourcesContent":["import * as fs from \"fs\";\nimport * as path from \"path\";\nimport { execSync } from \"child_process\";\nimport { sync as globSync } from \"glob\";\nimport * as readline from \"readline\";\nimport { detect } from \"detect-package-manager\";\n\nfunction askQuestion(query: string): Promise<string> {\n  return new Promise((resolve) => {\n    const rl = readline.createInterface({\n      input: process.stdin,\n      output: process.stdout,\n    });\n    rl.question(query, (answer) => {\n      rl.close();\n      resolve(answer);\n    });\n  });\n}\n\nfunction isPackageInstalled(pkg: string): boolean {\n  const cwd = process.cwd();\n  try {\n    const pkgJsonPath = path.join(cwd, \"package.json\");\n    if (fs.existsSync(pkgJsonPath)) {\n      const pkgJson = JSON.parse(fs.readFileSync(pkgJsonPath, \"utf8\"));\n      const deps = pkgJson.dependencies || {};\n      const devDeps = pkgJson.devDependencies || {};\n      if (deps[pkg] || devDeps[pkg]) {\n        return true;\n      }\n    }\n  } catch {\n    // Fall back to node_modules check below.\n  }\n  const modulePath = path.join(cwd, \"node_modules\", ...pkg.split(\"/\"));\n  return fs.existsSync(modulePath);\n}\n\nexport default async function installReactUILib(): Promise<void> {\n  const cwd = process.cwd();\n  const pattern = \"**/*.{js,jsx,ts,tsx}\";\n  const files = globSync(pattern, {\n    cwd,\n    ignore: [\"**/node_modules/**\", \"**/dist/**\", \"**/build/**\"],\n  });\n\n  let found = false;\n  for (const file of files) {\n    const fullPath = path.join(cwd, file);\n    const content = fs.readFileSync(fullPath, \"utf8\");\n    if (content.includes(\"@assistant-ui/react-ui\")) {\n      found = true;\n      break;\n    }\n  }\n\n  if (found) {\n    if (isPackageInstalled(\"@assistant-ui/react-ui\")) {\n      console.log(\n        \"@assistant-ui/react-ui is already installed. Skipping installation.\",\n      );\n      return;\n    }\n\n    const answer = await askQuestion(\n      \"React UI imports were added but @assistant-ui/react-ui is not installed. Do you want to install it? (Y/n) \",\n    );\n    if (answer === \"\" || answer.toLowerCase().startsWith(\"y\")) {\n      const pm = await detect();\n      let cmd = \"\";\n      if (pm === \"yarn\") {\n        cmd = \"yarn add @assistant-ui/react-ui\";\n      } else if (pm === \"pnpm\") {\n        cmd = \"pnpm add @assistant-ui/react-ui\";\n      } else if (pm === \"bun\") {\n        cmd = \"bun add @assistant-ui/react-ui\";\n      } else {\n        cmd = \"npm install @assistant-ui/react-ui\";\n      }\n      try {\n        execSync(cmd, { stdio: \"inherit\" });\n      } catch (e) {\n        console.error(\"Installation failed:\", e);\n      }\n    } else {\n      console.log(\"Skipping installation.\");\n    }\n  } else {\n    console.log(\"No React UI imports found; skipping installation.\");\n  }\n}\n"],"mappings":";AAAA,YAAY,QAAQ;AACpB,YAAY,UAAU;AACtB,SAAS,gBAAgB;AACzB,SAAS,QAAQ,gBAAgB;AACjC,YAAY,cAAc;AAC1B,SAAS,cAAc;AAEvB,SAAS,YAAY,OAAgC;AACnD,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,UAAM,KAAc,yBAAgB;AAAA,MAClC,OAAO,QAAQ;AAAA,MACf,QAAQ,QAAQ;AAAA,IAClB,CAAC;AACD,OAAG,SAAS,OAAO,CAAC,WAAW;AAC7B,SAAG,MAAM;AACT,cAAQ,MAAM;AAAA,IAChB,CAAC;AAAA,EACH,CAAC;AACH;AAEA,SAAS,mBAAmB,KAAsB;AAChD,QAAM,MAAM,QAAQ,IAAI;AACxB,MAAI;AACF,UAAM,cAAmB,UAAK,KAAK,cAAc;AACjD,QAAO,cAAW,WAAW,GAAG;AAC9B,YAAM,UAAU,KAAK,MAAS,gBAAa,aAAa,MAAM,CAAC;AAC/D,YAAM,OAAO,QAAQ,gBAAgB,CAAC;AACtC,YAAM,UAAU,QAAQ,mBAAmB,CAAC;AAC5C,UAAI,KAAK,GAAG,KAAK,QAAQ,GAAG,GAAG;AAC7B,eAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF,QAAQ;AAAA,EAER;AACA,QAAM,aAAkB,UAAK,KAAK,gBAAgB,GAAG,IAAI,MAAM,GAAG,CAAC;AACnE,SAAU,cAAW,UAAU;AACjC;AAEA,eAAO,oBAA0D;AAC/D,QAAM,MAAM,QAAQ,IAAI;AACxB,QAAM,UAAU;AAChB,QAAM,QAAQ,SAAS,SAAS;AAAA,IAC9B;AAAA,IACA,QAAQ,CAAC,sBAAsB,cAAc,aAAa;AAAA,EAC5D,CAAC;AAED,MAAI,QAAQ;AACZ,aAAW,QAAQ,OAAO;AACxB,UAAM,WAAgB,UAAK,KAAK,IAAI;AACpC,UAAM,UAAa,gBAAa,UAAU,MAAM;AAChD,QAAI,QAAQ,SAAS,wBAAwB,GAAG;AAC9C,cAAQ;AACR;AAAA,IACF;AAAA,EACF;AAEA,MAAI,OAAO;AACT,QAAI,mBAAmB,wBAAwB,GAAG;AAChD,cAAQ;AAAA,QACN;AAAA,MACF;AACA;AAAA,IACF;AAEA,UAAM,SAAS,MAAM;AAAA,MACnB;AAAA,IACF;AACA,QAAI,WAAW,MAAM,OAAO,YAAY,EAAE,WAAW,GAAG,GAAG;AACzD,YAAM,KAAK,MAAM,OAAO;AACxB,UAAI,MAAM;AACV,UAAI,OAAO,QAAQ;AACjB,cAAM;AAAA,MACR,WAAW,OAAO,QAAQ;AACxB,cAAM;AAAA,MACR,WAAW,OAAO,OAAO;AACvB,cAAM;AAAA,MACR,OAAO;AACL,cAAM;AAAA,MACR;AACA,UAAI;AACF,iBAAS,KAAK,EAAE,OAAO,UAAU,CAAC;AAAA,MACpC,SAAS,GAAG;AACV,gBAAQ,MAAM,wBAAwB,CAAC;AAAA,MACzC;AAAA,IACF,OAAO;AACL,cAAQ,IAAI,wBAAwB;AAAA,IACtC;AAAA,EACF,OAAO;AACL,YAAQ,IAAI,mDAAmD;AAAA,EACjE;AACF;","names":[]}